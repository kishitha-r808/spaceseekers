<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Space Weather Log</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
#image-preview { max-height:200px; cursor:pointer; }
.modal-bg { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.8); justify-content:center; align-items:center; overflow:auto; z-index:50; }
.modal-content { background:#111; padding:20px; border-radius:10px; max-width:90%; max-height:90%; overflow:auto; }
.modal-content img { max-width:200px; margin:10px; border-radius:8px; border:2px solid cyan; }
.close-btn { color:white; cursor:pointer; font-size:20px; float:right; margin-bottom:10px; }
</style>
</head>
<body class="bg-gray-900 text-white flex flex-col items-center justify-center min-h-screen p-4">

<h1 class="text-3xl text-cyan-400 mb-6">Space Weather Log</h1>
<div id="image-preview-container" class="border-2 border-dashed border-gray-600 p-4 rounded-lg flex justify-center items-center w-64 h-64 mb-4">
    <img id="image-preview" src="" alt="Preview" class="hidden">
    <span id="preview-text">Click here to view uploaded images</span>
</div>

<!-- Modal -->
<div id="modal" class="modal-bg flex">
    <div class="modal-content">
        <span class="close-btn" id="closeModal">&times;</span>
        <h2 class="text-white text-2xl mb-4">Uploaded Images</h2>
        <div id="all-images" class="flex flex-wrap justify-center"></div>
    </div>
</div>

<script>
const imagePreview = document.getElementById('image-preview');
const previewText = document.getElementById('preview-text');
const imagePreviewContainer = document.getElementById('image-preview-container');
const modal = document.getElementById('modal');
const closeModal = document.getElementById('closeModal');
const allImages = document.getElementById('all-images');

// Load last uploaded image as preview
let imagesArray = JSON.parse(localStorage.getItem('uploadedImages') || '[]');
let infoArray = JSON.parse(localStorage.getItem('uploadedInfo') || '[]');

if(imagesArray.length > 0){
    const lastImage = imagesArray[imagesArray.length - 1];
    imagePreview.src = lastImage;
    imagePreview.classList.remove('hidden');
    previewText.classList.add('hidden');
}

// Click preview to show modal with all images
imagePreviewContainer.addEventListener('click', function(){
    allImages.innerHTML = '';
    if(imagesArray.length === 0){
        allImages.innerHTML = '<p>No images uploaded yet.</p>';
    } else {
        imagesArray.forEach((img, index)=>{
            const imgElem = document.createElement('img');
            imgElem.src = img;
            imgElem.title = infoArray[index] || '';
            allImages.appendChild(imgElem);
        });
    }
    modal.style.display = 'flex';
});

closeModal.addEventListener('click', function(){
    modal.style.display = 'none';
});
</script>

</body>
</html>